<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DigiTech Film Collection</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body { font-family: sans-serif; background: #0f172a; color: white; padding: 24px; }
    .container { max-width: 1200px; margin: 0 auto; }
    .header { margin-bottom: 32px; }
    .stats-grid { display: flex; gap: 16px; margin-bottom: 24px; }
    .stat-card { flex: 1; padding: 16px; border-radius: 8px; background: #334155; text-align: center; }
    .stat-label { font-size: 12px; color: #cbd5e1; }
    .stat-value { font-size: 24px; font-weight: bold; }
    .tab-nav { display: flex; gap: 8px; margin-bottom: 16px; }
    .tab-btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; background: #475569; color: white; }
    .tab-btn.active { background: #fbbf24; color: #111827; }
    .content { display: none; }
    .content.active { display: block; }
    .chart-container { height: 400px; margin-bottom: 16px; }
    .film-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; }
    .film-card { background: #1e293b; padding: 12px; border-radius: 6px; text-align: center; }
    .film-emoji { font-size: 24px; }
    .film-title { font-weight: bold; margin-top: 8px; }
    .film-votes { color: #fbbf24; margin-top: 4px; font-size: 12px; }
</style>
</head>
<body>
<div class="container">

    <div class="header">
        <h1>DigiTech Film Collection</h1>
        <p class="header-subtitle"></p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Total Films</div>
            <div class="stat-value" id="totalFilms">0</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Unique Films</div>
            <div class="stat-value" id="uniqueFilms">0</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Total Responses</div>
            <div class="stat-value" id="totalResponses">0</div>
        </div>
    </div>

    <div class="tab-nav">
        <button class="tab-btn active" onclick="switchTab('overview', event)">Overview</button>
        <button class="tab-btn" onclick="switchTab('genres', event)">Genres</button>
        <button class="tab-btn" onclick="switchTab('timeline', event)">Timeline</button>
        <button class="tab-btn" onclick="switchTab('favorites', event)">Favorites</button>
        <button class="tab-btn" onclick="switchTab('funfacts', event)">Fun Facts</button>
    </div>

    <div id="overview" class="content active">
        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>
        <div class="film-grid"></div>
    </div>

    <div id="genres" class="content">
        <div class="chart-container">
            <canvas id="pieChart"></canvas>
        </div>
        <div class="genre-list"></div>
    </div>

    <div id="timeline" class="content">
        <div class="chart-container">
            <canvas id="lineChart"></canvas>
        </div>
    </div>

    <div id="favorites" class="content">
        <div class="hall-of-fame-list"></div>
    </div>

    <div id="funfacts" class="content">
        <div class="fun-facts-grid"></div>
    </div>

</div>

<script>
let barChart, pieChart, lineChart;
let surveyData = null;

async function loadData() {
    const response = await fetch('film-data.json');
    surveyData = await response.json();
    initializeApp();
}

function initializeApp() {
    document.querySelector('.header-subtitle').textContent = surveyData.survey.description;
    document.getElementById('totalFilms').textContent = surveyData.survey.totalFilms;
    document.getElementById('uniqueFilms').textContent = surveyData.survey.uniqueFilms;
    document.getElementById('totalResponses').textContent = surveyData.survey.totalResponses;

    populateFilms();
    populateGenres();
    populateHallOfFame();
    populateFunFacts();
    initializeCharts();
}

function populateFilms() {
    const grid = document.querySelector('.film-grid');
    grid.innerHTML = surveyData.films.map(f => `
        <div class="film-card">
            <div class="film-emoji">${f.emoji}</div>
            <div class="film-title">${f.title}</div>
            <div class="film-votes">${f.votes} votes</div>
        </div>
    `).join('');
}

function populateGenres() {
    const list = document.querySelector('.genre-list');
    list.innerHTML = surveyData.genres.map(g => `
        <div>
            <div class="genre-item">
                <span>${g.name}</span>
                <span style="color:#fbbf24">${g.count} films</span>
            </div>
        </div>
    `).join('');
}

function populateHallOfFame() {
    const list = document.querySelector('.hall-of-fame-list');
    list.innerHTML = surveyData.hallOfFame.map(e => `
        <div>
            <strong>${e.rank} ${e.film}</strong> - ${e.description} (${e.votes} votes)
        </div>
    `).join('');
}

function populateFunFacts() {
    const grid = document.querySelector('.fun-facts-grid');
    grid.innerHTML = surveyData.funFacts.map(f => `
        <div>
            <strong>${f.title}</strong>: ${f.fact}
        </div>
    `).join('');
}

function initializeCharts() {
    const topFilms = surveyData.films.slice(0,8);

    const barCtx = document.getElementById('barChart');
    barChart = new Chart(barCtx, {
        type: 'bar',
        data: { labels: topFilms.map(f => f.title), datasets: [{ label: 'Votes', data: topFilms.map(f => f.votes), backgroundColor:'#fbbf24' }] }
    });

    const pieCtx = document.getElementById('pieChart');
    pieChart = new Chart(pieCtx, {
        type: 'doughnut',
        data: { labels: surveyData.genres.map(g => g.name), datasets:[{ data: surveyData.genres.map(g => g.count), backgroundColor: surveyData.genres.map(g => g.color) }] }
    });

    const lineCtx = document.getElementById('lineChart');
    lineChart = new Chart(lineCtx, {
        type:'line',
        data: { labels: surveyData.timeline.map(t=>t.year), datasets:[{ label:'Films', data: surveyData.timeline.map(t=>t.count), borderColor:'#fbbf24', fill:false }] }
    });
}

function switchTab(tabName, event) {
    document.querySelectorAll('.content').forEach(c=>c.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    event?.target?.classList.add('active');
    setTimeout(()=>{ barChart?.resize(); pieChart?.resize(); lineChart?.resize(); },100);
}

document.addEventListener('DOMContentLoaded', loadData);
</script>
</body>
</html>
